{"name": "Login Test Case: DangNhap-1", "status": "broken", "statusDetails": {"message": "ValueError: dict contains fields not in fieldnames: 'Result', 'Screenshot', 'Video'", "trace": "tcid = 'DangNhap-1', email = 'luuthianduyen@gmail.com', password = 'luuthianduyen247', expected_message = 'Tài khoản của tôi'\n\n    @pytest.mark.parametrize(\n        \"tcid, email, password, expected_message\",\n        get_test_data(),\n    )\n    @allure.feature(\"Login\")\n    @allure.title(\"Login Test Case: {tcid}\")\n    def test_login(tcid, email, password, expected_message):\n    \n        allure.attach(\n            \"SQL SERVER\" if DATA_SOURCE == \"db\" else DATA_SOURCE,\n            name=\"DATA SOURCE\",\n            attachment_type=allure.attachment_type.TEXT,\n        )\n    \n        email = \"\" if email is None else str(email)\n        password = \"\" if password is None else str(password)\n        expected_message = \"\" if expected_message is None else str(expected_message)\n    \n        screenshot_path = os.path.join(SCREENSHOT_DIR, f\"{tcid}.png\")\n        final_video_path = os.path.join(VIDEO_DIR, f\"{tcid}.webm\")\n        result = \"FAIL\"\n    \n        with sync_playwright() as p:\n            browser = p.chromium.launch(\n                headless=False, slow_mo=500, args=[\"--start-maximized\"]\n            )\n            context = browser.new_context(\n                no_viewport=True,\n                record_video_dir=VIDEO_DIR,\n                record_video_size={\"width\": 1280, \"height\": 720},\n            )\n            page = context.new_page()\n            login_page = LoginPage(page, get_base_url())\n    \n            try:\n                login_page.goto()\n                login_page.login(email, password)\n    \n                if expected_message.strip():\n                    expect(page.get_by_text(expected_message, exact=False)).to_be_visible(\n                        timeout=10000\n                    )\n                else:\n                    expect(login_page.success_marker).to_be_visible(timeout=10000)\n    \n                result = \"PASS\"\n    \n            except AssertionError:\n                result = \"FAIL\"\n    \n            finally:\n                # Screenshot\n                page.screenshot(path=screenshot_path)\n                allure.attach.file(\n                    screenshot_path,\n                    name=f\"{tcid}_{result.lower()}\",\n                    attachment_type=allure.attachment_type.PNG,\n                )\n    \n                # Close để flush video\n                context.close()\n    \n                # Video\n                try:\n                    src_video = page.video.path()\n                except Exception:\n                    src_video = None\n    \n                if src_video and os.path.exists(src_video):\n                    shutil.move(src_video, final_video_path)\n                    allure.attach.file(\n                        final_video_path,\n                        name=f\"{tcid}_video\",\n                        attachment_type=allure.attachment_type.WEBM,\n                    )\n                else:\n                    final_video_path = \"\"\n    \n                browser.close()\n    \n                # Write result back\n>               write_result(tcid, result, screenshot_path, final_video_path)\n\ntests\\test_login.py:168: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\ntests\\test_login.py:75: in write_result\n    write_test_result_any(\nutils\\universal_result_writer.py:479: in write_test_result_any\n    _write_test_result_to_csv(\nutils\\universal_result_writer.py:136: in _write_test_result_to_csv\n    writer.writerow(row)\n..\\..\\..\\..\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\csv.py:226: in writerow\n    return self.writer.writerow(self._dict_to_list(rowdict))\n                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <csv.DictWriter object at 0x0000025417B12270>\nrowdict = {'Email': 'luuthianduyen@gmail.com', 'ExpectedMessage': 'Tài khoản của tôi', 'Password': 'luuthianduyen247', 'Result': 'PASS', ...}\n\n    def _dict_to_list(self, rowdict):\n        if self.extrasaction == \"raise\":\n            wrong_fields = rowdict.keys() - self.fieldnames\n            if wrong_fields:\n>               raise ValueError(\"dict contains fields not in fieldnames: \"\n                                 + \", \".join([repr(x) for x in wrong_fields]))\nE               ValueError: dict contains fields not in fieldnames: 'Result', 'Screenshot', 'Video'\n\n..\\..\\..\\..\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\csv.py:221: ValueError"}, "attachments": [{"name": "DATA SOURCE", "source": "f61dc05b-b065-4017-b32a-e58cc007d591-attachment.txt", "type": "text/plain"}, {"name": "DangNhap-1_pass", "source": "57dddbae-2835-4b32-a2b6-065da56bfb85-attachment.png", "type": "image/png"}, {"name": "DangNhap-1_video", "source": "99b34653-6092-460c-85d4-d47cb488ce6f-attachment.webm", "type": "video/webm"}], "parameters": [{"name": "tcid", "value": "'DangNhap-1'"}, {"name": "email", "value": "'luuthianduyen@gmail.com'"}, {"name": "password", "value": "'luuthianduyen247'"}, {"name": "expected_message", "value": "'Tài khoản của tôi'"}], "start": 1767889171046, "stop": 1767889180398, "uuid": "f03957ba-f918-4b8c-b706-0dea3240ef8c", "historyId": "8a48cc3de97501d6cd8bb178bd54aee1", "testCaseId": "a707b9555172d26c5c1ec2d556e674f3", "fullName": "tests.test_login#test_login", "labels": [{"name": "feature", "value": "Login"}, {"name": "parentSuite", "value": "tests"}, {"name": "suite", "value": "test_login"}, {"name": "host", "value": "LTADUYEN"}, {"name": "thread", "value": "19696-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "tests.test_login"}], "titlePath": ["tests", "test_login.py"]}